#include <iostream>
#include <systemc>

#include "top.hpp"
#include "types.hpp"
#include "vector"

int
sc_main(int, char*[]) {
    // shared_memory_weight = {{{0.5, 0.5}, {0.5, 0.5}}, {{0.5, 0.5}}};
    // shared_memory_data = {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};

    shared_memory_weight = {
        {
            {
                -0.139653, -0.222845, -0.213736, 0.146667,  0.249733,  0.091952,  -0.007412, 0.318734,  -0.190347,
                -0.029440, -0.033852, 0.072533,  0.023562,  -0.151712, -0.005665, -0.042885, -0.288849, -0.122407,
                -0.161579, 0.083698,  0.101668,  0.105905,  -0.190342, -0.163650, 0.239855,  -0.198916, -0.235080,
                -0.338650, -0.227081, 0.031794,  -0.148749, 0.098040,  0.160791,  -0.011495, -0.055291, 0.170277,
                -0.186740, 0.140196,  0.107160,  0.009003,  -0.206465, 0.095892,  0.041133,  0.080103,  -0.098616,
                -0.025582, 0.426895,  -0.023531, 0.035816,
            },
            {
                -0.092511, 0.071888,  -0.201828, 0.135508,  0.047727,  0.206877, 0.266498,  0.150124,  -0.173951,
                -0.200207, 0.175750,  -0.451326, -0.013181, -0.097519, 0.079282, -0.426693, 0.254005,  -0.333075,
                -0.051249, -0.248525, 0.058274,  0.023254,  0.111221,  0.065920, -0.538351, -0.308463, -0.120437,
                -0.177962, 0.355657,  0.071936,  0.048865,  0.295849,  0.195966, -0.106798, 0.085566,  0.102008,
                -0.234116, 0.260888,  0.273003,  -0.172173, 0.097918,  0.194755, 0.192942,  0.297311,  0.008579,
                -0.133864, 0.061554,  0.125623,  -0.123367,
            },
            {
                -0.201619, -0.020537, -0.137505, 0.035864,  -0.171293, -0.199096, 0.020923,  0.099331,  -0.211366,
                0.545363,  -0.205352, 0.321593,  -0.110046, -0.199333, 0.234791,  0.079364,  -0.209739, -0.180974,
                0.006405,  0.331061,  0.151831,  -0.121543, -0.049372, -0.106581, -0.063987, 0.256548,  0.100256,
                -0.060892, 0.096165,  0.228022,  0.014078,  0.003132,  0.207267,  0.034289,  -0.228793, 0.173245,
                -0.545793, -0.149014, 0.080322,  0.351659,  -0.206954, -0.171841, -0.242944, 0.081320,  0.037814,
                -0.135769, 0.356802,  0.255146,  -0.185246,
            },
            {
                0.070127,  0.251554,  -0.044893, -0.149285, 0.352526,  0.358964,  -0.073950, 0.045771,  -0.198994,
                -0.232742, 0.436666,  0.210129,  -0.205955, 0.072957,  -0.229986, 0.103676,  -0.063206, -0.073610,
                -0.207692, -0.060339, 0.226995,  -0.069655, 0.027024,  -0.013095, -0.189153, 0.121394,  0.109227,
                0.050940,  0.049511,  0.304782,  0.309699,  0.044092,  -0.425186, -0.084182, -0.230709, 0.112213,
                -0.398419, 0.009481,  -0.209884, 0.221289,  -0.488922, 0.333940,  -0.142083, 0.023038,  -0.559465,
                0.238364,  0.158543,  -0.522122, 0.005628,
            },
            {
                0.091710,  0.105859,  0.201081,  -0.077844, 0.149641,  0.071454,  0.067126,  0.036433,  0.275108,
                0.203946,  0.052854,  -0.079008, -0.196754, -0.076171, -0.190845, 0.043878,  -0.044823, -0.041046,
                0.045832,  0.186969,  0.113541,  -0.108579, 0.078429,  0.321132,  0.109203,  0.238376,  0.130798,
                -0.144528, 0.049768,  -0.176133, 0.337515,  -0.025648, -0.283855, -0.241112, 0.096190,  0.214227,
                -0.077462, -0.191260, 0.595399,  -0.100128, -0.308011, 0.301187,  -0.015293, 0.138812,  0.289313,
                0.019211,  0.111206,  -0.118425, -0.205002,
            },
            {
                0.367405,  0.071820,  -0.058507, 0.102943,  0.087672,  0.115305,  0.024335,  0.094895,  -0.326999,
                -0.513162, 0.136407,  0.002168,  -0.051147, -0.228450, -0.366340, -0.229706, 0.083492,  0.201360,
                -0.213924, -0.039506, -0.232070, 0.074801,  0.280025,  -0.006902, -0.171847, -0.213151, -0.247372,
                0.032104,  0.255963,  0.052255,  0.173886,  -0.457448, 0.168780,  0.345025,  0.232612,  -0.008338,
                -0.218280, 0.119542,  -0.013201, -0.378928, -0.085328, -0.006379, -0.408632, -0.167423, 0.443121,
                -0.113900, -0.039500, -0.297681, 0.006277,
            },
            {
                -0.322491, -0.157431, 0.141230,  -0.229037, -0.132700, -0.294161, 0.343763,  0.319994,  -0.256216,
                -0.258307, 0.312504,  -0.230338, 0.232849,  -0.289302, 0.164624,  0.065148,  0.119482,  -0.402247,
                0.181215,  0.117456,  -0.028653, -0.100204, 0.137621,  0.367804,  0.074098,  -0.210010, -0.019614,
                0.245655,  0.011412,  -0.051961, 0.317912,  -0.165482, 0.010950,  0.174365,  0.485258,  0.383862,
                0.184792,  0.249943,  -0.022117, -0.232266, 0.030065,  -0.141418, -0.262173, 0.137575,  -0.121588,
                -0.262760, -0.129657, 0.079098,  -0.099154,
            },
            {
                -0.315970, 0.300582,  -0.198837, -0.074962, 0.350528,  0.360132,  0.115236,  0.236049, 0.273796,
                0.184182,  0.071109,  -0.121977, 0.537959,  -0.118018, -0.576562, -0.441438, 0.310698, 0.170136,
                -0.194839, -0.099652, 0.048948,  0.053368,  0.101357,  -0.079738, 0.092065,  0.020858, -0.053726,
                -0.141234, 0.203332,  -0.200823, -0.148819, -0.191722, -0.152589, -0.256475, 0.177945, 0.122017,
                0.558255,  0.437365,  -0.114405, -0.050681, 0.008406,  0.198411,  0.036684,  0.043995, 0.135808,
                0.047009,  0.147461,  0.211899,  0.185357,
            },
            {
                -0.184531, 0.201539,  -0.030468, -0.165458, 0.106272,  0.536770,  -0.080096, 0.079242,  0.399021,
                -0.195841, -0.155645, 0.051829,  0.515984,  -0.147673, 0.165399,  -0.020852, 0.075053,  -0.085180,
                0.124316,  -0.427301, 0.174247,  -0.100242, 0.204177,  0.254814,  0.145503,  -0.065223, 0.262743,
                -0.157437, 0.444569,  -0.154724, -0.467881, 0.160331,  -0.069962, -0.000711, 0.012286,  0.212766,
                0.228871,  -0.030465, 0.062223,  0.048038,  0.519899,  0.306710,  0.195370,  -0.090087, -0.416333,
                -0.095198, 0.290373,  -0.022766, -0.338260,
            },
            {
                -0.014637, -0.004000, 0.000747,  -0.064257, -0.025684, 0.207873,  -0.101927, -0.220466, 0.231007,
                0.339538,  -0.153766, 0.102160,  0.359262,  -0.174798, -0.133230, -0.146960, -0.065007, -0.174442,
                -0.135651, -0.009454, 0.208533,  -0.037114, -0.235512, 0.093494,  0.023162,  -0.219939, -0.072976,
                0.331724,  -0.055303, -0.184605, -0.160888, 0.112469,  0.046107,  0.471757,  -0.171463, 0.213797,
                0.235550,  0.289027,  0.025250,  -0.357643, 0.163880,  0.124814,  0.072090,  -0.348731, -0.010847,
                -0.055043, -0.131730, -0.006057, 0.125430,
            },
            {
                -0.135751, 0.341879,  -0.003546, 0.075515,  -0.079428, -0.176279, -0.143328, -0.114074, -0.432857,
                0.228425,  0.140336,  0.030159,  -0.552735, 0.065610,  -0.344619, -0.033169, -0.159585, -0.100960,
                -0.189594, 0.509813,  0.092523,  0.321554,  -0.033697, 0.204370,  -0.027463, 0.113599,  0.235204,
                -0.222362, -0.207078, -0.001444, -0.052076, -0.026611, -0.293273, 0.018593,  0.235685,  -0.015754,
                -0.610195, 0.134147,  0.255302,  -0.060926, -0.531352, -0.129282, -0.036531, -0.120990, 0.049589,
                0.257469,  0.190247,  -0.396310, 0.371770,
            },
            {
                0.022259,  0.222079,  0.415774,  0.143470,  -0.218525, -0.044145, 0.414018, 0.315386,  0.314487,
                -0.204999, 0.144729,  0.021704,  0.454633,  -0.092586, 0.148875,  0.187375, -0.011127, -0.106708,
                -0.287093, 0.465542,  -0.221553, -0.189850, 0.267953,  -0.193643, 0.098243, 0.291575,  -0.310969,
                -0.330759, -0.424018, 0.202459,  0.093135,  -0.111643, 0.386712,  0.019665, -0.428506, -0.021256,
                0.264040,  -0.139483, -0.560259, 0.234914,  0.545061,  -0.378705, 0.338143, 0.098038,  -0.349381,
                0.159942,  0.360684,  0.268759,  0.163675,
            },
            {
                -0.046908, 0.038126,  0.322622,  0.117786,  -0.006425, 0.162542,  -0.016752, -0.323830, -0.282179,
                0.611442,  0.180143,  0.017309,  -0.201980, -0.406156, -0.004383, 0.229543,  -0.412237, 0.079270,
                -0.304296, 0.154254,  -0.307962, 0.187858,  0.032342,  0.044372,  -0.068040, 0.151629,  -0.457550,
                0.087090,  -0.051010, 0.181370,  -0.035185, -0.148751, 0.073606,  0.142496,  0.108490,  -0.320121,
                -0.384501, 0.333141,  0.040269,  0.391672,  -0.446325, -0.202870, 0.097020,  -0.308463, -0.183788,
                0.218649,  0.011158,  0.138735,  0.207696,
            },
            {
                -0.114470, 0.160841, 0.204911,  0.238273,  -0.105762, -0.384316, 0.146149,  0.152589,  0.039080,
                0.437961,  0.067517, 0.247750,  0.561623,  0.076777,  0.096747,  -0.085301, -0.409273, 0.260629,
                0.053652,  0.046239, -0.086805, -0.206335, 0.043821,  -0.132396, -0.106386, 0.018143,  0.170122,
                0.140738,  0.168841, 0.087784,  0.157486,  0.146969,  -0.324981, 0.222340,  -0.362417, -0.146026,
                0.323776,  0.048716, -0.038023, -0.253736, -0.062352, -0.186366, -0.041937, -0.055998, 0.045577,
                0.155000,  0.353679, -0.514258, -0.019750,
            },
            {
                -0.106806, -0.291393, 0.006173,  -0.257989, -0.156420, -0.152324, 0.001511,  0.109537,  -0.044274,
                0.084618,  -0.118737, 0.045484,  -0.180110, -0.452214, 0.093621,  -0.162788, 0.123637,  0.078745,
                -0.100268, -0.361742, 0.249597,  0.289760,  0.149285,  -0.042463, -0.198029, 0.133126,  0.019123,
                -0.079231, 0.452972,  -0.130875, 0.317437,  -0.206513, -0.113227, -0.071539, 0.134184,  0.123069,
                0.070481,  -0.088242, 0.278767,  -0.271989, -0.035968, -0.078982, -0.124542, -0.154009, 0.460031,
                -0.187134, 0.399805,  -0.153699, -0.206036,
            },
            {
                -0.046787, -0.095599, -0.172822, 0.183861,  -0.129126, 0.026960,  0.022676,  0.295749,  -0.004774,
                0.055101,  0.179165,  0.056063,  -0.046350, 0.057927,  0.133343,  0.310778,  -0.298499, -0.396247,
                -0.069129, -0.080408, -0.100012, 0.128763,  0.030999,  -0.233732, -0.051244, 0.155722,  0.116372,
                -0.142719, 0.076044,  0.142524,  0.072220,  0.195097,  0.070836,  0.145111,  -0.322099, -0.099459,
                -0.600319, -0.175465, -0.217577, -0.064877, -0.324397, 0.206393,  0.250666,  0.215595,  -0.037621,
                -0.042780, 0.250941,  -0.305327, 0.061062,
            },
            {
                0.002036,  0.255243,  0.272028,  -0.112910, 0.115284, -0.214176, -0.121791, 0.408917, -0.237782,
                -0.333424, 0.021257,  0.072875,  -0.589093, 0.105292, 0.079240,  0.105438,  0.143429, -0.189619,
                0.303141,  -0.318982, 0.262014,  0.316784,  0.092802, 0.149989,  -0.111951, 0.002773, 0.210422,
                -0.071434, 0.046213,  0.092757,  -0.420938, 0.020223, 0.069818,  -0.058411, 0.288635, 0.286964,
                -0.112541, 0.276321,  0.118930,  -0.251946, 0.113270, 0.146999,  -0.042008, 0.156048, 0.246228,
                0.017146,  0.140710,  -0.024149, 0.114339,
            },
            {
                0.225760,  0.145754,  -0.489667, 0.001717,  0.102656, 0.177200,  0.358300,  -0.109639, 0.061510,
                -0.284440, -0.083569, -0.290650, -0.248983, 0.135147, -0.242312, -0.028784, 0.343362,  -0.157670,
                0.053018,  -0.461668, -0.099099, 0.150568,  0.250858, 0.109029,  -0.139329, 0.019119,  0.394735,
                0.181424,  0.440982,  -0.052310, 0.188476,  0.008462, -0.035067, -0.126385, -0.042077, 0.155518,
                0.137772,  -0.200655, 0.199712,  -0.208743, 0.346315, 0.390888,  0.310921,  0.058032,  -0.036967,
                -0.062149, -0.279122, 0.119105,  -0.017808,
            },
            {
                -0.206616, 0.029008,  -0.324938, 0.348684,  0.215756, 0.020237,  -0.019026, -0.231630, 0.128280,
                0.135428,  0.140230,  0.029126,  0.186361,  0.066683, 0.249962,  -0.052714, 0.277015,  0.008308,
                0.039313,  -0.010038, -0.184554, 0.082653,  0.314720, 0.176217,  -0.282182, -0.201474, 0.182315,
                0.261513,  0.100124,  -0.261906, 0.105251,  0.292828, 0.086972,  0.003560,  0.084455,  0.188546,
                -0.026120, -0.310968, 0.156853,  -0.035010, 0.041086, -0.322000, 0.008133,  -0.055995, 0.153510,
                -0.058832, 0.231055,  0.256247,  0.123302,
            },
            {
                0.067888,  0.107862,  0.001536,  -0.122497, -0.184098, -0.197541, -0.112515, 0.003308,  -0.274393,
                0.372790,  -0.047545, 0.190255,  -0.299457, -0.052824, -0.112207, 0.059441,  -0.600487, 0.265580,
                -0.014527, 0.194653,  0.451431,  -0.171214, 0.139952,  0.332996,  -0.247146, 0.147523,  0.211758,
                -0.157908, -0.087132, -0.084879, -0.113626, -0.386400, 0.143940,  0.282617,  -0.024165, -0.166725,
                -0.438465, -0.211046, 0.161541,  -0.024919, -0.723122, 0.095812,  0.372292,  0.146089,  -0.024095,
                0.040670,  -0.113524, 0.051641,  -0.234014,
            },
            {
                0.025805,  -0.086673, -0.366804, 0.066672,  -0.040680, -0.091951, -0.279503, -0.473498, -0.277377,
                0.010431,  0.008677,  0.130124,  -0.200205, 0.037692,  -0.283381, 0.035968,  0.048518,  -0.233904,
                0.225891,  0.081404,  -0.140322, 0.465748,  -0.022534, -0.044530, 0.384666,  0.168187,  0.211568,
                0.007710,  0.046632,  -0.049636, 0.413600,  0.014456,  -0.029485, -0.207744, 0.118767,  0.064161,
                0.084112,  -0.097739, -0.059136, -0.381605, 0.014329,  0.338108,  0.000593,  0.188036,  0.190903,
                -0.017569, -0.060576, 0.036035,  0.405263,
            },
            {
                -0.002694, -0.275559, 0.199742,  0.042699, -0.153024, 0.128480,  -0.344341, -0.004907, 0.575844,
                -0.097609, -0.351311, 0.244454,  0.364211, -0.367922, 0.048239,  -0.185530, 0.002837,  -0.155764,
                -0.137005, -0.050243, 0.090934,  0.262799, 0.074736,  -0.253421, -0.083238, 0.143226,  -0.158880,
                0.032240,  -0.083845, 0.169025,  0.153853, -0.025117, -0.218056, 0.316613,  -0.270658, -0.248189,
                0.633499,  0.070296,  -0.516915, 0.061965, 0.547630,  -0.282740, 0.222536,  0.054792,  -0.223588,
                0.076377,  0.006344,  0.183058,  0.286426,
            },
            {
                0.020672,  0.707898,  0.075131,  0.057854, 0.144597,  0.108563,  0.272571,  0.002132,  -0.116463,
                0.219985,  0.030560,  0.274671,  0.272958, -0.010381, 0.030943,  0.369246,  -0.153689, 0.009615,
                -0.155398, 0.097620,  0.110320,  0.160016, -0.077878, 0.166584,  0.079587,  0.034769,  0.145669,
                -0.024534, -0.139614, 0.562508,  0.325315, 0.010500,  -0.269817, -0.104581, -0.460937, -0.163808,
                0.041903,  0.246390,  0.001188,  0.152118, 0.139859,  -0.533082, -0.097678, -0.159810, 0.098532,
                -0.262306, -0.114114, -0.167799, 0.244351,
            },
            {
                -0.162684, -0.346797, -0.493720, -0.221843, 0.196304,  -0.402791, 0.055315,  -0.148838, 0.658390,
                0.079448,  0.017789,  -0.092772, 0.463799,  0.073766,  -0.020265, -0.027247, -0.325588, 0.351927,
                0.235359,  -0.004636, -0.029606, 0.486921,  -0.392876, 0.003720,  0.096273,  -0.073518, -0.076455,
                0.106745,  -0.412181, -0.085136, 0.002901,  0.218985,  -0.151295, 0.148373,  0.007143,  -0.242562,
                0.418698,  -0.060842, 0.016994,  0.045898,  0.684513,  -0.102929, 0.118854,  0.023086,  -0.048173,
                -0.214543, 0.046181,  -0.318913, 0.212881,
            },
            {
                0.197013,  -0.158354, -0.346053, -0.129759, -0.507885, -0.173222, -0.090692, -0.043294, -0.095678,
                -0.103754, -0.021843, -0.187329, 0.403371,  0.049038,  0.085727,  -0.056699, 0.232712,  0.120208,
                0.110232,  0.123731,  -0.383962, -0.215710, 0.143627,  0.133139,  0.410944,  0.211259,  -0.170288,
                0.071705,  0.009328,  -0.403703, 0.094856,  -0.033193, -0.059254, -0.229812, -0.093253, 0.399996,
                0.599701,  0.103582,  0.367376,  -0.049798, 0.399662,  0.097154,  -0.121080, -0.157268, -0.317194,
                0.299876,  0.135556,  0.136803,  0.070928,
            },
        },
        {
            {
                0.449226,  -0.316597, 0.565340,  0.581988,  0.078067,  0.279731,  -0.295351, -0.785657, -0.759502,
                -0.157196, 0.813879,  -0.226007, 0.718944,  -0.054647, -0.126791, 0.526075,  0.145125,  -0.338184,
                -0.157487, 0.823602,  -0.137245, -0.339833, 0.277246,  -0.487413, -0.625777,
            },
            {
                0.104578,  0.437847,  -0.504577, 0.032979,  0.240601,  0.254331,  0.151134,  0.244108, 0.422110,
                -0.205311, -0.218095, -0.704192, -0.605219, -0.594101, 0.286547,  -0.234937, 0.578757, 0.695649,
                0.056142,  -0.477469, 0.194138,  -0.218731, -0.733112, -0.247660, 0.528794,
            },
            {
                -0.064458, -0.419555, -0.131795, -0.414905, -0.196549, -0.243058, -0.257266, 0.138076,  0.394134,
                0.391138,  -0.776120, 0.711539,  -0.109143, 0.247962,  -0.338686, -0.431866, -0.689206, -0.186566,
                0.025385,  -0.539036, -0.316456, 0.840634,  0.446551,  0.800076,  0.276799,
            },
        }};

    shared_memory_data = {0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0,
                          0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0};

    TENSOR_UNIT tensor_unit("tens_unit", 49, 1, 3, 25);
    tensor_unit.set_shared_memory(shared_memory_data, shared_memory_weight, shared_memory_result);

    // init_tensor_unit();
    bind_tu(tensor_unit);
    printf("start\n");
    sc_core::sc_start();
    return 0;
}
